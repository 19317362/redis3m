\hypertarget{classredis3m_1_1patterns_1_1scheduler}{\section{redis3m\-:\-:patterns\-:\-:scheduler Class Reference}
\label{classredis3m_1_1patterns_1_1scheduler}\index{redis3m\-::patterns\-::scheduler@{redis3m\-::patterns\-::scheduler}}
}


A scheduler pattern, can be useful to manage \char`\"{}jobs\char`\"{} that needs to be run at a given time. It's fault tolerant and scalable. Multiple workers can be dispatched and jobs will be executed only once. See \href{http://luca3m.me/2013/12/03/redis-scheduler.html}{\tt http\-://luca3m.\-me/2013/12/03/redis-\/scheduler.\-html} for other infos.  




{\ttfamily \#include $<$scheduler.\-h$>$}

\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classredis3m_1_1patterns_1_1scheduler_af1443d367272951cd84e994774612dcf}{scheduler} (const std\-::string \&queue\-\_\-name)
\begin{DoxyCompactList}\small\item\em Scheduler constructor. \end{DoxyCompactList}\item 
void \hyperlink{classredis3m_1_1patterns_1_1scheduler_aa135834d88c1ec7d68dcae36cf843a4b}{append\-\_\-enqueue} (connection\-::ptr\-\_\-t \hyperlink{classredis3m_1_1connection}{connection}, const std\-::string \&object\-\_\-id, const boost\-::posix\-\_\-time\-::ptime \&time)
\begin{DoxyCompactList}\small\item\em Append Redis commands needed to enqueue a job, useful to use inside transactions. \end{DoxyCompactList}\item 
void \hyperlink{classredis3m_1_1patterns_1_1scheduler_a2d6d1df91fb760b0202fe02d34ea7281}{append\-\_\-enqueue} (connection\-::ptr\-\_\-t \hyperlink{classredis3m_1_1connection}{connection}, const std\-::string \&object\-\_\-id, const boost\-::posix\-\_\-time\-::time\-\_\-duration \&delay)
\begin{DoxyCompactList}\small\item\em Append Redis commands needed to enqueue a job, useful to use inside transactions. \end{DoxyCompactList}\item 
void \hyperlink{classredis3m_1_1patterns_1_1scheduler_aebeb86b14442dd0441f12de25b15747d}{enqueue} (connection\-::ptr\-\_\-t \hyperlink{classredis3m_1_1connection}{connection}, const std\-::string \&object\-\_\-id, const boost\-::posix\-\_\-time\-::ptime \&time)
\begin{DoxyCompactList}\small\item\em Put a job in schedule. \end{DoxyCompactList}\item 
void \hyperlink{classredis3m_1_1patterns_1_1scheduler_a7145ca9c64ad32a7feb6f11e84fff47b}{enqueue} (connection\-::ptr\-\_\-t \hyperlink{classredis3m_1_1connection}{connection}, const std\-::string \&object\-\_\-id, const boost\-::posix\-\_\-time\-::time\-\_\-duration \&delay)
\begin{DoxyCompactList}\small\item\em Put a job in schedule. \end{DoxyCompactList}\item 
void \hyperlink{classredis3m_1_1patterns_1_1scheduler_aabce4c75556019e2330b3235291b26a5}{append\-\_\-dequeue} (connection\-::ptr\-\_\-t \hyperlink{classredis3m_1_1connection}{connection}, const std\-::string \&object\-\_\-id)
\begin{DoxyCompactList}\small\item\em Append Redis commands to remove a job from queue, use it when worker ends a job. Otherwise it will fire on another worker. It's like \hyperlink{classredis3m_1_1patterns_1_1scheduler_a4e5f91b6f52da015407458c96dce07d9}{dequeue()} but to be used inside transactions. \end{DoxyCompactList}\item 
void \hyperlink{classredis3m_1_1patterns_1_1scheduler_a4e5f91b6f52da015407458c96dce07d9}{dequeue} (connection\-::ptr\-\_\-t \hyperlink{classredis3m_1_1connection}{connection}, const std\-::string \&object\-\_\-id)
\begin{DoxyCompactList}\small\item\em Remove a job from queue, use it when worker ends a job. Otherwise it will fire on another worker. \end{DoxyCompactList}\item 
std\-::string \hyperlink{classredis3m_1_1patterns_1_1scheduler_a170c9c40c4b9e8c5c722dc9be73b6366}{find\-\_\-expired} (connection\-::ptr\-\_\-t \hyperlink{classredis3m_1_1connection}{connection}, const boost\-::posix\-\_\-time\-::time\-\_\-duration \&lock\-\_\-for=boost\-::posix\-\_\-time\-::seconds(60))
\begin{DoxyCompactList}\small\item\em Return a fired job, it will be locked for an amount of time. During this time the worker will run the job and then call \hyperlink{classredis3m_1_1patterns_1_1scheduler_a4e5f91b6f52da015407458c96dce07d9}{dequeue()}. If worker crashes, the job will fire on another worker after lock period. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
A scheduler pattern, can be useful to manage \char`\"{}jobs\char`\"{} that needs to be run at a given time. It's fault tolerant and scalable. Multiple workers can be dispatched and jobs will be executed only once. See \href{http://luca3m.me/2013/12/03/redis-scheduler.html}{\tt http\-://luca3m.\-me/2013/12/03/redis-\/scheduler.\-html} for other infos. 

\subsection{Constructor \& Destructor Documentation}
\hypertarget{classredis3m_1_1patterns_1_1scheduler_af1443d367272951cd84e994774612dcf}{\index{redis3m\-::patterns\-::scheduler@{redis3m\-::patterns\-::scheduler}!scheduler@{scheduler}}
\index{scheduler@{scheduler}!redis3m::patterns::scheduler@{redis3m\-::patterns\-::scheduler}}
\subsubsection[{scheduler}]{\setlength{\rightskip}{0pt plus 5cm}scheduler\-::scheduler (
\begin{DoxyParamCaption}
\item[{const std\-::string \&}]{queue\-\_\-name}
\end{DoxyParamCaption}
)}}\label{classredis3m_1_1patterns_1_1scheduler_af1443d367272951cd84e994774612dcf}


Scheduler constructor. 


\begin{DoxyParams}{Parameters}
{\em queue\-\_\-name} & redis key used to store jobs, in a Z\-S\-E\-T \\
\hline
\end{DoxyParams}


\subsection{Member Function Documentation}
\hypertarget{classredis3m_1_1patterns_1_1scheduler_aabce4c75556019e2330b3235291b26a5}{\index{redis3m\-::patterns\-::scheduler@{redis3m\-::patterns\-::scheduler}!append\-\_\-dequeue@{append\-\_\-dequeue}}
\index{append\-\_\-dequeue@{append\-\_\-dequeue}!redis3m::patterns::scheduler@{redis3m\-::patterns\-::scheduler}}
\subsubsection[{append\-\_\-dequeue}]{\setlength{\rightskip}{0pt plus 5cm}void scheduler\-::append\-\_\-dequeue (
\begin{DoxyParamCaption}
\item[{connection\-::ptr\-\_\-t}]{connection, }
\item[{const std\-::string \&}]{object\-\_\-id}
\end{DoxyParamCaption}
)}}\label{classredis3m_1_1patterns_1_1scheduler_aabce4c75556019e2330b3235291b26a5}


Append Redis commands to remove a job from queue, use it when worker ends a job. Otherwise it will fire on another worker. It's like \hyperlink{classredis3m_1_1patterns_1_1scheduler_a4e5f91b6f52da015407458c96dce07d9}{dequeue()} but to be used inside transactions. 


\begin{DoxyParams}{Parameters}
{\em connection} & \\
\hline
{\em object\-\_\-id} & \\
\hline
\end{DoxyParams}
\hypertarget{classredis3m_1_1patterns_1_1scheduler_aa135834d88c1ec7d68dcae36cf843a4b}{\index{redis3m\-::patterns\-::scheduler@{redis3m\-::patterns\-::scheduler}!append\-\_\-enqueue@{append\-\_\-enqueue}}
\index{append\-\_\-enqueue@{append\-\_\-enqueue}!redis3m::patterns::scheduler@{redis3m\-::patterns\-::scheduler}}
\subsubsection[{append\-\_\-enqueue}]{\setlength{\rightskip}{0pt plus 5cm}void scheduler\-::append\-\_\-enqueue (
\begin{DoxyParamCaption}
\item[{connection\-::ptr\-\_\-t}]{connection, }
\item[{const std\-::string \&}]{object\-\_\-id, }
\item[{const boost\-::posix\-\_\-time\-::ptime \&}]{time}
\end{DoxyParamCaption}
)}}\label{classredis3m_1_1patterns_1_1scheduler_aa135834d88c1ec7d68dcae36cf843a4b}


Append Redis commands needed to enqueue a job, useful to use inside transactions. 


\begin{DoxyParams}{Parameters}
{\em connection} & a valid redis connection \\
\hline
{\em object\-\_\-id} & an object id, can be everything, like a reference to an Redis hash \\
\hline
{\em time} & absolute U\-T\-C time, when job will fire \\
\hline
\end{DoxyParams}
\hypertarget{classredis3m_1_1patterns_1_1scheduler_a2d6d1df91fb760b0202fe02d34ea7281}{\index{redis3m\-::patterns\-::scheduler@{redis3m\-::patterns\-::scheduler}!append\-\_\-enqueue@{append\-\_\-enqueue}}
\index{append\-\_\-enqueue@{append\-\_\-enqueue}!redis3m::patterns::scheduler@{redis3m\-::patterns\-::scheduler}}
\subsubsection[{append\-\_\-enqueue}]{\setlength{\rightskip}{0pt plus 5cm}void scheduler\-::append\-\_\-enqueue (
\begin{DoxyParamCaption}
\item[{connection\-::ptr\-\_\-t}]{connection, }
\item[{const std\-::string \&}]{object\-\_\-id, }
\item[{const boost\-::posix\-\_\-time\-::time\-\_\-duration \&}]{delay}
\end{DoxyParamCaption}
)}}\label{classredis3m_1_1patterns_1_1scheduler_a2d6d1df91fb760b0202fe02d34ea7281}


Append Redis commands needed to enqueue a job, useful to use inside transactions. 


\begin{DoxyParams}{Parameters}
{\em connection} & a valid redis connection \\
\hline
{\em object\-\_\-id} & an object id, can be everything, like a reference to an Redis hash \\
\hline
{\em delay} & Job will fire at now() + delay \\
\hline
\end{DoxyParams}
\hypertarget{classredis3m_1_1patterns_1_1scheduler_a4e5f91b6f52da015407458c96dce07d9}{\index{redis3m\-::patterns\-::scheduler@{redis3m\-::patterns\-::scheduler}!dequeue@{dequeue}}
\index{dequeue@{dequeue}!redis3m::patterns::scheduler@{redis3m\-::patterns\-::scheduler}}
\subsubsection[{dequeue}]{\setlength{\rightskip}{0pt plus 5cm}void scheduler\-::dequeue (
\begin{DoxyParamCaption}
\item[{connection\-::ptr\-\_\-t}]{connection, }
\item[{const std\-::string \&}]{object\-\_\-id}
\end{DoxyParamCaption}
)}}\label{classredis3m_1_1patterns_1_1scheduler_a4e5f91b6f52da015407458c96dce07d9}


Remove a job from queue, use it when worker ends a job. Otherwise it will fire on another worker. 


\begin{DoxyParams}{Parameters}
{\em connection} & \\
\hline
{\em object\-\_\-id} & \\
\hline
\end{DoxyParams}
\hypertarget{classredis3m_1_1patterns_1_1scheduler_aebeb86b14442dd0441f12de25b15747d}{\index{redis3m\-::patterns\-::scheduler@{redis3m\-::patterns\-::scheduler}!enqueue@{enqueue}}
\index{enqueue@{enqueue}!redis3m::patterns::scheduler@{redis3m\-::patterns\-::scheduler}}
\subsubsection[{enqueue}]{\setlength{\rightskip}{0pt plus 5cm}void scheduler\-::enqueue (
\begin{DoxyParamCaption}
\item[{connection\-::ptr\-\_\-t}]{connection, }
\item[{const std\-::string \&}]{object\-\_\-id, }
\item[{const boost\-::posix\-\_\-time\-::ptime \&}]{time}
\end{DoxyParamCaption}
)}}\label{classredis3m_1_1patterns_1_1scheduler_aebeb86b14442dd0441f12de25b15747d}


Put a job in schedule. 


\begin{DoxyParams}{Parameters}
{\em connection} & a valid redis connection \\
\hline
{\em object\-\_\-id} & an object id, can be everything, like a reference to an Redis hash \\
\hline
{\em time} & absolute U\-T\-C time, when job will fire \\
\hline
\end{DoxyParams}
\hypertarget{classredis3m_1_1patterns_1_1scheduler_a7145ca9c64ad32a7feb6f11e84fff47b}{\index{redis3m\-::patterns\-::scheduler@{redis3m\-::patterns\-::scheduler}!enqueue@{enqueue}}
\index{enqueue@{enqueue}!redis3m::patterns::scheduler@{redis3m\-::patterns\-::scheduler}}
\subsubsection[{enqueue}]{\setlength{\rightskip}{0pt plus 5cm}void scheduler\-::enqueue (
\begin{DoxyParamCaption}
\item[{connection\-::ptr\-\_\-t}]{connection, }
\item[{const std\-::string \&}]{object\-\_\-id, }
\item[{const boost\-::posix\-\_\-time\-::time\-\_\-duration \&}]{delay}
\end{DoxyParamCaption}
)}}\label{classredis3m_1_1patterns_1_1scheduler_a7145ca9c64ad32a7feb6f11e84fff47b}


Put a job in schedule. 


\begin{DoxyParams}{Parameters}
{\em connection} & a valid redis connection \\
\hline
{\em object\-\_\-id} & an object id, can be everything, like a reference to an Redis hash \\
\hline
{\em delay} & Job will fire at now() + delay \\
\hline
\end{DoxyParams}
\hypertarget{classredis3m_1_1patterns_1_1scheduler_a170c9c40c4b9e8c5c722dc9be73b6366}{\index{redis3m\-::patterns\-::scheduler@{redis3m\-::patterns\-::scheduler}!find\-\_\-expired@{find\-\_\-expired}}
\index{find\-\_\-expired@{find\-\_\-expired}!redis3m::patterns::scheduler@{redis3m\-::patterns\-::scheduler}}
\subsubsection[{find\-\_\-expired}]{\setlength{\rightskip}{0pt plus 5cm}std\-::string scheduler\-::find\-\_\-expired (
\begin{DoxyParamCaption}
\item[{connection\-::ptr\-\_\-t}]{connection, }
\item[{const boost\-::posix\-\_\-time\-::time\-\_\-duration \&}]{lock\-\_\-for = {\ttfamily boost\-:\-:posix\-\_\-time\-:\-:seconds(60)}}
\end{DoxyParamCaption}
)}}\label{classredis3m_1_1patterns_1_1scheduler_a170c9c40c4b9e8c5c722dc9be73b6366}


Return a fired job, it will be locked for an amount of time. During this time the worker will run the job and then call \hyperlink{classredis3m_1_1patterns_1_1scheduler_a4e5f91b6f52da015407458c96dce07d9}{dequeue()}. If worker crashes, the job will fire on another worker after lock period. 


\begin{DoxyParams}{Parameters}
{\em connection} & \\
\hline
{\em lock\-\_\-for} & lock delay, by default 1 min \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
An object id or an empty string if none found 
\end{DoxyReturn}


The documentation for this class was generated from the following files\-:\begin{DoxyCompactItemize}
\item 
include/redis3m/patterns/scheduler.\-h\item 
src/patterns/scheduler.\-cpp\end{DoxyCompactItemize}
